# $gitDictectory = "C:\Projects\CMS\sources\Fingrid"
# Set-Location -Path $gitDictectory

# $easter = @"
#      .-.            .-.
#     /   \          /   \
#    |   _ \        / _   |
#    ;  | \ \      / / |  ;
#     \  \ \ \_.._/ / /  /
#      '. '.;'    ';,' .'
#        './ _    _ \.'
#        .'  a __ a  '.
#   '--./ _,   \/   ,_ \.--'
#  ----|   \   /\   /   |----
#   .--'\   '-'  '-'    /'--.
#       _>.__  -- _.-  `;
#     .' _     __/     _/
#    /    '.,:".-\    /:,
#    |      \.'   `""`'.\\
#     '-,.__/  _   .-.  ;|_
#     /` `|| _/ `\/_  \_|| `\
#    |    ||/ \-./` \ / ||   |
#     \   ||__/__|___|__||  /
#      \_ |_Happy Easter_| /
#     .'  \ =  _= _ = _= /`\
#    /     `-;----=--;--'   \
#    \    _.-'        '.    /
#     `""`              `""`
# "@

# Write-Host $asciiArt -ForegroundColor Magenta

# Set-Location -Path "C:\Projects\config exporter\development"

$yes_man = "                                                 
                                          +++                                                       
                                     *+++++++++                                                     
                                   +++=:::::=++                                                     
                                 ++=-:::::::-++                                                     
                                ++-:::::::::=+                                                      
                                ++:::::::::++                                                       
                                +++-----==+++                                                       
                                ++++++++++++                                                        
                                 ++++++++++                                                         
                                  +++++++++++           +++++++++++++++                             
                                ++++++=---+++          +++++++++++==+++++                           
                                +++:::::::=++        *+++:::::::::::::-++*                          
                                +++-::::::-++        +++-:::::::::::::::+++                         
                                +++-::::-::++       ++++-:::::::::::::::-++                         
                                +++=:::---:=+ **    ++++::-----::::::::::+++                        
                                +++=--------+*++    ++++-------:-*===-::::+++                       
                                ++++------=++====*  +++=-----=+=====+:::::=++                       
                                ++++=----++=======* +++=---++=====+*:::::::+++                      
                                ++++=--=++========*++++=-+======++:::::::::-+++                     
                                ++++=--+=====+==*=*+++*+======+*++-:::::::::=++                     
                                +++++--+======+=+**+*======*+-++++++:::::::::+++                    
                                +++++--+======+==++=+==++=:::=+ +++++::::::::=++                    
                                *++++---+======**+*+---=:::::++  +++++::::::::+++                   
                                 ++++=--=+=+=:+:-*=-=*+++:::-++    ++++-::::::-++                   
                                 +++**+=+*+:----*-+-----+*--=*++++++++++-::::::=++                  
                                 ++**==+=+:---------=---=:-+-+---:::::::::::::::++                  
                   ++++++        ++++=--=-:-----++++-++-=:-=+==*::::::::::::::::=++                 
             ++++=::::+++        ++++=--=+:=--*---:+::-:-=---*:=:::::::::::::::::++*                
            +++-::::::+++        ++++=-++=+----:-=+--++++=:+=-+::::::::::::::::::-++                
           +++-:::::::-++        ++++=--+==--:--------::---::+=:::::::--+++++:::::=++               
         +++++::::::::-++        ++++=-+--+-::---:::=**++*:=-=*++++++++++++++-::::-++               
         +++++:::::::::++        ++++=----=+--:-+++====+===-===+*++++++++++++=:::::-++              
         +++++:::::::::=++       ++++=-----+**=+=+=============+==*     ++++++::::::++              
          ++++-::::::::-++       ++++-----=*===================+====*    +++++-:::::-++             
          ++++-:::::::::++       ++++-=++===========+====++=++==*=====*  +++++=::::::+++            
          ++++=:::::::::-++      ++**===============*-:::::::++======*** ++++++::::::-++            
           ++++-::::::::-=++   +*+==========+=====+:::-:::-=:====*=*+-:-=*+++++-::::::=++           
            +++=::::::-----++++*=======+=+=+======--:::::::*:+====   *--:-*++++=:::::::++           
            ++++=:::::-------+-:*+====+=--==+=====*::::::::=======*  *----+*++++:::::::-++          
             ++++=:::::------+----*+*=----*=========**+**+==+=====**=:--** +++++=:::::::+++         
              +++++-:::::-----==----*=---+==========++=+==========+-::*    +++++++++++++++          
               *+++++=::::------*-----=+=+=========================*=*      ++++++++++++            
                 ++++++++-:::-----*+--::+=====+********++===+****+=**       +++++                   
                  +++++++++++++++++++*===:-::-:::-==++=----:-:--:=:-:=*                             
                    *++++++++++++++++=:-+-::::::::::::::::::::::::-+:-* **                          
                       ++++++++++++==+:-=:::::::::::::::::::::::::-=--*-==*                         
                           +++++++*+---+:::::::::::::::::::::::::::+--+**                           
                                   ****=:::::::::::::::::-::::::::::*--:-*                          
                                      +::::::::::::=*   *-:::::::::::*                              
                                     *-:::::::::::=+    *--:::::::::::*                             
                                     +::::::::::::=*    *:-::::::::::::*                            
                                    *-::::::::::::-*    *:::::::::::::::*                           
                                    **+=--::-::-+**     *+=++**********                             
                                           *==*             *-:=#                                   
                                           *:-*#            *=-=#                                   
                                           *:-*             *+-*                                    
                                           *==*             *=-*                                    
                                       ****+-=**#           *+*** ***                               
                                 ==*+=---=------=*         *=----=+=*=**                            
                              ===*=---------=+-==*========*==--=----------+*                        
                            ===*==+**+*+========================+**++==------+*                     
                            =============  ==================================+**==                  
                                        Ja, it is short trouser day!!
                                      https://kanikeenkortebroekaan.nl/
"

$no_man = "                                                                                
                                                                              ###########           
                                                                 #  %########*+---------#           
                                                         #%%    ##*+=------------------=#           
                                         #######*++====---=*# %##=---------------------=#           
                                      ##*=------------------#%###+---------------------=#           
                                     ##*--------------------*####*--------*#******#######           
                                    ###*--------------------+####*--------*###########              
                           #########%##*---------=+*########## ###---------## #%%%#                 
                           ##------#####-------#############   ###---------##                       
          %#########      ###------*####+------=#              ###---------*#                       
         ##*-------=##    ###*-----=#####-------##        ###  ###===+++===*#                       
        ###*---------##   ####------#####--------##      #+==* %###++++++**############             
        ###*----------*#   ###------+####+-------+#      #*+++  ###+#+---------+#+=--#%             
        ###*-----------*#  ####------#####--------######****#+*%#+---------------+=--#              
        ####------------##  ###------#####-------===++++++++##*-*==-------=------=+-=#              
        ####-------------+#####+-----+####+---===+++++++*=-:::::=#-=+--*+#=*=----#--=#              
        ####--------------=#####------#####-=+++++++#::=-+:+=++=+::*=---+*=*=+-=######              
         ###----------------####------+####=-=++#:::::::::::=+:::::::=*--*=***######                
         ###=--------##=-----###+------#####+++++#+::::::::=#*++:::::::+=-#*=-##      ####%         
         ###+--------+##*-----###------+####+++*+::::::::::::-##+#:-::::#=-----####*+=---+#         
          ##*--------=####-----==----=++#####+*-::::::::::::-*+=+*##+:::*+*---------------#         
          ###---------#####----------=++#####+::::::::::-+:-=:-+:::*#-#+=#-*--------------#         
          ###---------+#####-------=+++++**====*+*::::*=#+::::*:-*:*=*#++#--+-------------##        
           ##=--------=# ####----=+++++**======++=+=#-:::::=*=:::=:::#:=+#--+=---=+########%        
           ##*---------#% ####--=+++++#============*==*=::::::=++:-#=*:#+#---#=##########           
           ###---------=#  ####+++++*+================++=::::::::##%######---+#####                 
            ##=---------#   %###+++#=+==================+::::=*###########----#                     
            ###---------+#   ######==*=+==+==============*-:::#          #----#                     
             ##=--++######    ####===*=+===*=====++=+=+=====**#          #----*                     
             ###########        %+===*=+===#=====::::::::*=#+=#          #=---#                     
             #####%             #====*=+===*=+:::::::-::::*+==#           *-=#                      
                                +====#=+===*==+-:::::::-=--#==#                                     
                               #=====*=+===*====*::*-:+*====#=*                                     
                               #====*=+====++======**==*+===+**                                     
                               #====+=+====+###########*=====#*                                     
                               #+*##=======*-------------==*=##                                     
                                #-=-+####**=------------=+==+:#                                     
                                #=-=-+-:==---------------=-+=:#                                     
                                 #*-+==:++--------------+-++:-#                                     
                                   #*=+:=#=------------+-*#=:-#                                     
                                     #*::#+----------==+*---*=#                                     
                                   %+::::-*=+------=+*#-=----#                                      
                                   #=:::::*#===---##   #==---+#                                     
                                    +::::::##-----#    #==----#                                     
                                   #-:*::::*##-*--#    #==----#                                     
                                 #-:+##-+%+=##-*--#    #==----#                                     
                                #::*% *:##+-##-=--#    *-=---=#                                     
                                ###  #+*%####-+--=#   #--=---*                                      
                                      #    #+=---#   #=-+----#                                      
                                          #=*---+#  #+-=----+#                                      
                                        #++----=#  #*--=----#                                       
                                     ##=+-----+#  #*-==---=*#####                                   
                                   ######*#########:*----:-+*---##                                  
                                  *-:=-::::::=-+-+##*++#==--::::::-*#                               
                                 ##=--*=-:::::::::::-#####################                          
                              #######%## ######***+++=*#     #############                          
                                  Nee, it is NOT short trouser day!!
                                  https://kanikeenkortebroekaan.nl/                                                          
"

# URL of the webpage to fetch images from
$url = 'https://kanikeenkortebroekaan.nl'


# $images = $webResponse.Images
# $fileName = Split-Path $images.src[0] -Leaf
# Write-Host "Processing image: $fileName" -ForegroundColor Blue
# Invoke-WebRequest -Uri "$url/assets/$fileName" -OutFile $fileName

# foreach ($image in $images) {
#     $fileName = Split-Path $image.src -Leaf
#     Write-Host "Processing image: $fileName" -ForegroundColor Blue
    
#     # Download the image
#     Invoke-WebRequest -Uri "https://kanikeenkortebroekaan.nl/assets/$fileName" -OutFile $fileName
# }


if (-not (Get-Module -Name AzureRM -ListAvailable)) {
  Write-Output "No Azure found in this setting, starting installing, please wait..."
  Install-Module -Name Az -Repository PSGallery -Force
}

# Authenticate to Azure
Connect-AzAccount

# Variables
$keyVaultName = "cms-fingrid-dev3-kv"
$secretName = "composer-api-key"

# Retrieve the secret
$secret = Get-AzKeyVaultSecret -VaultName $keyVaultName -Name $secretName

# Output the secret value
$secretValue = $secret.SecretValueText
Write-Output "The secret value is: $secretValue"



#Write-Host $yes_man -ForegroundColor Yellow